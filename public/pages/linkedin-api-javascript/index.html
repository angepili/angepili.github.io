<!DOCTYPE html>
<html lang="en-us">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<style type=text/css>body{font-family:monospace;}</style>
	
	
	<link rel="stylesheet" href="/css/style.css">
	
	


	<title>Linkedin Login con Javascript  - AngeloPili.it</title>
<meta charset="utf-8">
<meta name="HandheldFriendly" content="True">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="MobileOptimized" content="320">
<meta name="generator" content="HUGO v0.77.0" />
<meta name="msapplication-TileImage" content="/pwa/ms-icon-144x144.png">
<meta name="author"      content="">
<meta name="description" content="Come sviluppare una login linkedin con le API in Javascript ES6: attraverso l&rsquo;utilizzo delle Promise andiamo a fare l&rsquo;autenticazione e prendere i dati del profilo.">
<meta name="keywords"    content="Development, API, Javascript, Linkedin">
<meta property="og:locale" content="it-it">
<meta property="og:type" content="blog">
<meta property="og:title"       content="Linkedin Login con Javascript">
<meta property="og:description" content="Come sviluppare una login linkedin con le API in Javascript ES6: attraverso l&rsquo;utilizzo delle Promise andiamo a fare l&rsquo;autenticazione e prendere i dati del profilo.">
<meta property="og:url"         content="https://angelopili.it/pages/linkedin-api-javascript/">
<meta property="og:site_name"   content="Linkedin Login con Javascript">
<meta property="og:image"       content="https://angelopili.it/uploads/linkedin-part-2/linkedin-api-javascript.png">
<meta property="twitter:image"  content="https://angelopili.it/uploads/linkedin-part-2/linkedin-api-javascript.png">
<meta property="og:latitude"    content="45.4642700"/>
<meta property="og:longitude"   content="9.1895100"/>
<meta property="og:locality"    content="Milan"/>
<meta property="og:country-name"content="Italy"/>

<meta name="twitter:title"      content="Linkedin Login con Javascript">
<meta name="twitter:description" content="Come sviluppare una login linkedin con le API in Javascript ES6: attraverso l&rsquo;utilizzo delle Promise andiamo a fare l&rsquo;autenticazione e prendere i dati del profilo.">

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:creator" content="@ngpi71" />
<meta name="twitter:site" content="@ngpi71" />


<meta name="robots" content="index, follow"/>
<meta name="googlebot" content="index,follow" />

<link rel="canonical" href="https://angelopili.it/pages/linkedin-api-javascript/" />

<link rel="apple-touch-icon" sizes="57x57" href="/pwa/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/pwa/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/pwa/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/pwa/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/pwa/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/pwa/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/pwa/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/pwa/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/pwa/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="/pwa/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="/pwa/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="/pwa/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="/pwa/favicon-16x16.png">
<link rel="manifest" href="/pwa/manifest.json?v=1604307388">

<link rel="icon" type="image/x-icon" href="https://angelopili.it/favicon.ico?v=1604307388">
<link rel="apple-touch-icon-precomposed" href="https://angelopili.it/favicon.png?v=1604307388">

</head>
<body>
	<header>
	===================<br>
	== <a href="https://angelopili.it/">AngeloPili.it</a> ==<br>
	===================
	<div>Appunti di sviluppo</div>
	<p>
	<nav>
			<a href="/"><b>Start</b></a>.
			
			
			<a href="/categories/"><b>Categories</b></a>.
			
			<a href="/tags/"><b>Tags</b></a>.
			
	</nav>
	</p>
	
</header>

	
	<main>
		<article>
			<h1>Linkedin Login con Javascript</h1>
			<b><time>24.07.2020</time></b>
		       
		           <a href="/tags/api">API</a>
        	       
		           <a href="/tags/javascript">Javascript</a>
        	       
		           <a href="/tags/linkedin">Linkedin</a>
        	       

			<div>
				<p>Nel precedente post <a href="/post/linkedin-api-postman">Linkedin Login con Postman</a> abbiamo visto come consumare le <strong>API di linkedin</strong> attraverso postman, ora invece passiamo ai fatti rieseguendo tutti i passaggi con Javascript.</p>
<p>Per comodità utilizzeremo lo scaffolding di Parcel, dato che di partenza ha già tutto configurato ( ho scritto un post a riguardo <a href="/post/creare-progetto-parceljs/">Creare un progetto parceljs</a> ), ma volendo si può integrare in qualsiasi altro scaffolding ad esempio webpack.</p>
<p>Per connetterci avremmo bisosgno quindi di un bottone &ldquo;accedi con linkedin&rdquo; e un div che farà da wrapper per restituire i nostri dati dopo l&rsquo;autenticazione. In un file html quindi ci mettiamo il giusto necessario:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"><span style="color:#75715e">&lt;!DOCTYPE html&gt;</span>
&lt;<span style="color:#f92672">html</span> <span style="color:#a6e22e">lang</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;en&#34;</span>&gt;
&lt;<span style="color:#f92672">head</span>&gt;
    &lt;<span style="color:#f92672">meta</span> <span style="color:#a6e22e">charset</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;UTF-8&#34;</span>&gt;
    &lt;<span style="color:#f92672">meta</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;viewport&#34;</span> <span style="color:#a6e22e">content</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;width=device-width, initial-scale=1.0&#34;</span>&gt;
    &lt;<span style="color:#f92672">title</span>&gt;Linkedn&lt;/<span style="color:#f92672">title</span>&gt;

&lt;/<span style="color:#f92672">head</span>&gt;
&lt;<span style="color:#f92672">body</span>&gt;

    &lt;<span style="color:#f92672">img</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;https://content.linkedin.com/content/dam/developer/global/en_US/site/img/signin-button.png&#34;</span> <span style="color:#a6e22e">alt</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;linkedin&#34;</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;linkedin-login&#34;</span>&gt;

    &lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;profile&#34;</span>&gt;&lt;/<span style="color:#f92672">div</span>&gt;

    &lt;<span style="color:#f92672">script</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;./index.js&#34;</span>&gt;&lt;/<span style="color:#f92672">script</span>&gt;
&lt;/<span style="color:#f92672">body</span>&gt;
&lt;/<span style="color:#f92672">html</span>&gt;
</code></pre></div><p>Passiamo alla parte di Javascript ed iniziamo ad installare le dipendenze, ci serviranno:</p>
<ul>
<li><a href="https://www.npmjs.com/package/axios">axios</a>: per le richieste http</li>
<li><a href="https://www.npmjs.com/package/qs">querystring</a>: per convertire in stringa i parametri da un oggetto</li>
<li><a href="https://www.npmjs.com/package/store">store</a>: per memorizzare i dati su local storage</li>
</ul>
<p>quindi da terminale:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">npm i --save axios querystring store
</code></pre></div><p>e sul nostro file Javascript</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">axios</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;axios&#39;</span>;
<span style="color:#66d9ef">import</span> <span style="color:#a6e22e">querystring</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;querystring&#39;</span>;
<span style="color:#66d9ef">import</span> <span style="color:#a6e22e">store</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;store&#39;</span>;
</code></pre></div><p>Creiamo un file .env sulla root del progetto con i seguenti parametri</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-toml" data-lang="toml"><span style="color:#a6e22e">CLIENT_ID</span>=<span style="color:#960050;background-color:#1e0010">$</span>{<span style="color:#a6e22e">tuo</span><span style="color:#960050;background-color:#1e0010">-</span><span style="color:#a6e22e">cliente</span><span style="color:#960050;background-color:#1e0010">-</span><span style="color:#a6e22e">id</span>}
<span style="color:#a6e22e">CLIENT_SECRET</span>=<span style="color:#960050;background-color:#1e0010">$</span>{<span style="color:#a6e22e">tuo</span><span style="color:#960050;background-color:#1e0010">-</span><span style="color:#a6e22e">cliente</span><span style="color:#960050;background-color:#1e0010">-</span><span style="color:#a6e22e">secret</span>}
<span style="color:#a6e22e">REDIRECT_URI</span>=<span style="color:#960050;background-color:#1e0010">$</span>{<span style="color:#a6e22e">tuo</span><span style="color:#960050;background-color:#1e0010">-</span><span style="color:#a6e22e">redirect</span>}
</code></pre></div><p>Con il .env avremo ben separati la parte di variabili di ambiente dal codice, ed avere quindi la possibilità di diversi setting per locale e produzione; ovviamente questo file sarebbe utile tracciarlo sul .gitignore per escluderlo dal versionamento.</p>
<p>Iniziamo a dichiarare un pò di variabili sul Javascript, tra cui anche quelle di ambiente:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">client_id</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">process</span>.<span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">CLIENT_ID</span>;
<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">client_secret</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">process</span>.<span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">CLIENT_SECRET</span>;
<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">redirect_uri</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">process</span>.<span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">REDIRECT_URI</span>;

<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">corsUrl</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;https://cors-anywhere.herokuapp.com/&#39;</span>; <span style="color:#75715e">// Proxy per bypassare CORS
</span><span style="color:#75715e"></span>
<span style="color:#75715e">// Endpoint
</span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">url</span> <span style="color:#f92672">=</span> {
    <span style="color:#a6e22e">auth</span>    <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;https://www.linkedin.com/oauth/v2/authorization&#39;</span>,
    <span style="color:#a6e22e">token</span>   <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;https://www.linkedin.com/oauth/v2/accessToken&#39;</span>,
    <span style="color:#a6e22e">me</span>      <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;https://api.linkedin.com/v2/me&#39;</span>
}

<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">parameters</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">URLSearchParams</span>(window.<span style="color:#a6e22e">location</span>.<span style="color:#a6e22e">search</span>); <span style="color:#75715e">// Per ottenere i parametri GET
</span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">btnLogin</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">getElementById</span>(<span style="color:#e6db74">&#39;linkedin-login&#39;</span>); <span style="color:#75715e">// Bottone
</span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">wrapper</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">getElementById</span>(<span style="color:#e6db74">&#39;profile&#39;</span>); <span style="color:#75715e">// Wrapper
</span></code></pre></div><h2 id="le-funzioni-javascript-per-la-login-api-di-linkedin">Le funzioni javascript per la login API di Linkedin</h2>
<p>Ora che abbiamo tutte le variabili di cui abbiamo bisogno, possiamo iniziare a scrivere le funzioni che richiameranno gli endpoint, e restituiranno le informazioni che ci occorrono.
La prima funziona che ci occorre è quella che apre la login di Linkedin e ci restituisce il parametro <em>code</em>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">LnkLogin</span> <span style="color:#f92672">=</span> ()=&gt; {
    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">params</span> <span style="color:#f92672">=</span> {
        <span style="color:#a6e22e">response_type</span><span style="color:#f92672">:</span><span style="color:#e6db74">&#39;code&#39;</span>,
        <span style="color:#a6e22e">client_id</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">client_id</span>,
        <span style="color:#a6e22e">state</span><span style="color:#f92672">:</span> Math.<span style="color:#a6e22e">floor</span>(Date.<span style="color:#a6e22e">now</span>() <span style="color:#f92672">/</span> <span style="color:#ae81ff">1000</span>),
        <span style="color:#a6e22e">redirect_uri</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">redirect_uri</span>,
        <span style="color:#a6e22e">scope</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;r_liteprofile r_emailaddress w_member_social&#39;</span>
    }
    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">urlWindow</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">`</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">getEndpoint</span>(<span style="color:#e6db74">&#39;auth&#39;</span>,<span style="color:#66d9ef">false</span>)<span style="color:#e6db74">}</span><span style="color:#e6db74">?</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">querystring</span>.<span style="color:#a6e22e">stringify</span>(<span style="color:#a6e22e">params</span>)<span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>;
    window.<span style="color:#a6e22e">open</span>(<span style="color:#a6e22e">urlWindow</span>,<span style="color:#e6db74">&#39;_self&#39;</span>);
}
</code></pre></div><p>Dobbiamo richiedere il token di sessione a Linkedin, imprescindibile per eseguire tutte le future chiamate.
Con javascript inizializzeremo una promises:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">LnkToken</span> <span style="color:#f92672">=</span> ()=&gt; {
    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">config</span> <span style="color:#f92672">=</span> {
        <span style="color:#a6e22e">grant_type</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;authorization_code&#39;</span>,
        <span style="color:#a6e22e">client_id</span> <span style="color:#f92672">:</span> <span style="color:#a6e22e">client_id</span>,
        <span style="color:#a6e22e">client_secret</span> <span style="color:#f92672">:</span> <span style="color:#a6e22e">client_secret</span> ,
        <span style="color:#a6e22e">redirect_uri</span> <span style="color:#f92672">:</span> <span style="color:#a6e22e">redirect_uri</span>,
        <span style="color:#a6e22e">code</span> <span style="color:#f92672">:</span> <span style="color:#a6e22e">parameters</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#39;code&#39;</span>)
    }
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> Promise((<span style="color:#a6e22e">resolve</span>, <span style="color:#a6e22e">reject</span>) =&gt; {
        <span style="color:#a6e22e">axios</span>.<span style="color:#a6e22e">post</span>(<span style="color:#a6e22e">getEndpoint</span>(<span style="color:#e6db74">&#39;token&#39;</span>),<span style="color:#a6e22e">querystring</span>.<span style="color:#a6e22e">stringify</span>(<span style="color:#a6e22e">config</span>),{
            <span style="color:#a6e22e">headers</span><span style="color:#f92672">:</span> { 
                <span style="color:#e6db74">&#39;content-type&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;application/x-www-form-urlencoded&#39;</span>,
            },
        })
        .<span style="color:#a6e22e">then</span> ( <span style="color:#a6e22e">result</span> =&gt; {
            <span style="color:#a6e22e">resolve</span>(<span style="color:#a6e22e">result</span>.<span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">access_token</span>) 
        })
        .<span style="color:#66d9ef">catch</span>( <span style="color:#a6e22e">err</span> =&gt; <span style="color:#a6e22e">reject</span>(<span style="color:#a6e22e">err</span>) )
    });
}
</code></pre></div><p>Ora che abbiamo ottenuto il token, siamo autenticati con Linkedin e d&rsquo;ora in poi dovremmo passarlo nell&rsquo;header della richiesta con un Authorization Bearer.
Questa chiamata all&rsquo;API ci permetterà di ottenere i nostri dati personali come nome, cognome ed indirizzo email.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">LnkMe</span> <span style="color:#f92672">=</span> ()=&gt; {
    <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">token</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">store</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#39;linkedin&#39;</span>);
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> Promise((<span style="color:#a6e22e">resolve</span>, <span style="color:#a6e22e">reject</span>) =&gt; {
        <span style="color:#a6e22e">axios</span>.<span style="color:#a6e22e">get</span>(<span style="color:#a6e22e">getEndpoint</span>(<span style="color:#e6db74">&#39;me&#39;</span>),{
            <span style="color:#a6e22e">headers</span><span style="color:#f92672">:</span> { 
                <span style="color:#e6db74">&#39;Authorization&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">`Bearer </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">token</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>,
            },
        })
        .<span style="color:#a6e22e">then</span> ( <span style="color:#a6e22e">response</span> =&gt; {
            <span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">response</span>.<span style="color:#a6e22e">data</span><span style="color:#f92672">?</span>.<span style="color:#a6e22e">id</span>) {
                <span style="color:#a6e22e">store</span>.<span style="color:#a6e22e">set</span>(<span style="color:#e6db74">&#39;linkedin&#39;</span>,{
                    ...<span style="color:#a6e22e">store</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#39;linkedin&#39;</span>),
                    ...<span style="color:#a6e22e">response</span>.<span style="color:#a6e22e">data</span>
                })
                <span style="color:#a6e22e">resolve</span>(<span style="color:#a6e22e">response</span>.<span style="color:#a6e22e">data</span>)
            }
            <span style="color:#a6e22e">reject</span>(<span style="color:#a6e22e">err</span>)
        })
        .<span style="color:#66d9ef">catch</span>( <span style="color:#a6e22e">err</span> =&gt; <span style="color:#a6e22e">reject</span>(<span style="color:#a6e22e">err</span>) )
    });
}
</code></pre></div><p>Non è previsto un endpoint per eseguire il logout, semplicemente andremmo a distruggere il token, i dati che abbiamo memorizzato e reinizializziamo l&rsquo;applicazione.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#75715e">/**
</span><span style="color:#75715e"> * Eseguo il logout
</span><span style="color:#75715e"> */</span>
<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">LnkLogout</span> <span style="color:#f92672">=</span> () =&gt; {
    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">btnExit</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">getElementById</span>(<span style="color:#e6db74">&#39;logout&#39;</span>);
        <span style="color:#a6e22e">btnExit</span>.<span style="color:#a6e22e">addEventListener</span>(<span style="color:#e6db74">&#39;click&#39;</span>,()=&gt; { 
            <span style="color:#a6e22e">store</span>.<span style="color:#a6e22e">clearAll</span>();
            <span style="color:#a6e22e">btnLogin</span>.<span style="color:#a6e22e">style</span>.<span style="color:#a6e22e">display</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;block&#39;</span>;
            <span style="color:#a6e22e">wrapper</span>.<span style="color:#a6e22e">innerHTML</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>;
            window.<span style="color:#a6e22e">location</span>.<span style="color:#a6e22e">search</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>;
            <span style="color:#a6e22e">init</span>();
        })
}
</code></pre></div><p>Per comodità, mettiamo tutto in una funziona l&rsquo;output dei dati</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#75715e">/**
</span><span style="color:#75715e"> * Stampo i miei dati
</span><span style="color:#75715e"> */</span>
<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">LnkProfile</span> <span style="color:#f92672">=</span> ()=&gt; {
    <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">localizedFirstName</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">firstname</span>, <span style="color:#a6e22e">localizedLastName</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">lastname</span>  } <span style="color:#f92672">=</span> <span style="color:#a6e22e">store</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#39;linkedin&#39;</span>);
    <span style="color:#a6e22e">wrapper</span>.<span style="color:#a6e22e">innerHTML</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">`
</span><span style="color:#e6db74">        Benvenuto &lt;strong&gt;</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">firstname</span><span style="color:#e6db74">}</span><span style="color:#e6db74"> </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">lastname</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&lt;/strong&gt; | &lt;a href=&#34;javascript:void(0)&#34; id=&#34;logout&#34;&gt;Logout&lt;/a&gt;
</span><span style="color:#e6db74">    `</span>
    <span style="color:#66d9ef">return</span>;
}
</code></pre></div><p>La funzione di inizializzazione verifica in quale stato siamo, e richiama gli eventi necessari</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">init</span> <span style="color:#f92672">=</span> ()=&gt; {
    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">linkedin</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">store</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#39;linkedin&#39;</span>);
    <span style="color:#75715e">// Se sono loggato, esiste l&#39;oggetto linkedin, e quindi il token
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span>( <span style="color:#a6e22e">linkedin</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">linkedin</span>.<span style="color:#a6e22e">token</span> ){

        <span style="color:#a6e22e">btnLogin</span>.<span style="color:#a6e22e">style</span>.<span style="color:#a6e22e">display</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;none&#39;</span> <span style="color:#75715e">// Nascondo il bottone
</span><span style="color:#75715e"></span>        <span style="color:#a6e22e">LnkProfile</span>(); <span style="color:#75715e">// Stampo i dati
</span><span style="color:#75715e"></span>        <span style="color:#a6e22e">LnkLogout</span>(); <span style="color:#75715e">// Se clicco su logout, distruggo la sessione
</span><span style="color:#75715e"></span>    } 
    <span style="color:#75715e">// Abbiamo appena ottenuto il CODE ma non ancora il token
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">parameters</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#39;code&#39;</span>) <span style="color:#f92672">&amp;&amp;</span> <span style="color:#f92672">!</span><span style="color:#a6e22e">linkedin</span><span style="color:#f92672">?</span>.<span style="color:#a6e22e">token</span> ){

        <span style="color:#a6e22e">btnLogin</span>.<span style="color:#a6e22e">style</span>.<span style="color:#a6e22e">display</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;none&#39;</span> <span style="color:#75715e">// nascondo il bottone
</span><span style="color:#75715e"></span>
        <span style="color:#a6e22e">LnkToken</span>() <span style="color:#75715e">// Avvio la catena di richieste per connettermi a linkedin
</span><span style="color:#75715e"></span>        .<span style="color:#a6e22e">then</span>( <span style="color:#a6e22e">token</span> =&gt; <span style="color:#a6e22e">store</span>.<span style="color:#a6e22e">set</span>(<span style="color:#e6db74">&#39;linkedin&#39;</span>,{ <span style="color:#a6e22e">token</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">token</span> }) )
        .<span style="color:#a6e22e">then</span>( ()=&gt; <span style="color:#a6e22e">LnkMe</span>() )
        .<span style="color:#a6e22e">then</span>( ()=&gt; <span style="color:#a6e22e">LnkProfile</span>() )
        .<span style="color:#a6e22e">then</span>( ()=&gt; <span style="color:#a6e22e">LnkLogout</span>() )
        .<span style="color:#66d9ef">catch</span>( <span style="color:#a6e22e">err</span> =&gt; <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">err</span>) )

    } 
    <span style="color:#75715e">// Lo stato di partenza, ancora non ho nulla, devo intereccettare il click del bottone
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">else</span> {
        <span style="color:#a6e22e">btnLogin</span>.<span style="color:#a6e22e">addEventListener</span>(<span style="color:#e6db74">&#39;click&#39;</span>, ()=&gt; <span style="color:#a6e22e">LnkLogin</span>() );
    }
}
</code></pre></div><p>Infine per far partire l&rsquo;applicazione, basterà richiamare la funzione <em>init()</em></p>
<p>L&rsquo;applicazione completa è disponibile su github <a href="https://github.com/angepili/linkedin-login">Linkedin Login</a></p>
<p>Nel prossimo post, vedremo come <strong>Pubblicare un post su linkedin tramite le API</strong></p>

			</div>
		</article>
	</main>
<aside>
	<div>
		<div>
			<h3>Ultimi post</h3>
		</div>
		<div>
			<ul>
				
				<li><a href="/pages/tipi-in-javascript/">I tipi di dati in Javascript</a></li>
				
				<li><a href="/pages/creare-un-dominio-locale-con-apache-con-https/">Abilitare https su Apache in locale</a></li>
				
				<li><a href="/pages/svelte-js/">Svelte Framework: come funziona, una veloce introduzione.</a></li>
				
				<li><a href="/pages/commenti-youtube-javascript/">Ottenere i commenti Youtube tramite API con Javascript</a></li>
				
				<li><a href="/pages/ottenere-commenti-video-youtube/">Ottenere i commenti di un video Youtube tramite API con Postman</a></li>
				
			</ul>
		</div>
	</div>
</aside>


	<footer>
	<p>&copy; 2020 <a href="https://angelopili.it/"><b>AngeloPili.it</b></a>.
	<a href="https://github.com/angepili"><b>Github</b></a>.
	<a href="https://www.linkedin.com/in/angelopili/"><b>Linkedin</b></a>.
	<a href="https://twitter.com/ngpi71"><b>Twitter</b></a>.
	</p>
</footer>

	
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-116693958-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

</body>
</html>
